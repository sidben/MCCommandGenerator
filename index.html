<!doctype html>
<html>

<head>
	<title>Minecraft Command Generator</title>
	<meta charset="utf-8" />
	<meta name="author" content="Sidney Benetti">

<!-- TODO: CSS/LESS file -->
<style type="text/css">
*	 	{ box-sizing: border-box; }
h1 		{ font: bold 20px arial }
body 	{ font: normal 14px Calibri; line-height: 130%; }
footer	{ padding: 25px 10px 15px; text-align: center; font-size: 12px; color: #777; }


.boxGeneric { border: 1px solid #ccc; padding: 10px; margin: 8px 0; background: #eee; }



/*-- Mob Selector --*/
#boxMobType 		{ display: none; }

#boxMobType .boxMob { margin: 5px; padding: 0 0 10px; width: 160px; display: inline-block; vertical-align: top; }

.boxMob .boxPortrait { background: #fff; width: 150px; height: 150px; margin: 2px auto; overflow: hidden; border: 1px solid #ccc; position: relative; cursor: pointer; }
.boxMob .boxPortrait img { width: 100%; }
.boxMob .mobName		{ background: rgba(200,200,200,0.85); color: #333; padding: 5px 10px; text-align: center; position: absolute; bottom: 4%; left: 0; width: 100%; display: none; }

.boxMob .boxCommand { visibility: hidden; }
.boxMob .boxCommand span {
	background: #0051a7; background-repeat: no-repeat; background-position: 0px 0px;
	border: 1px solid #0051a7; color: #fff;
	width: 75px; padding: 3px 0 3px 32px; display: inline-block; margin: 1px 2px; cursor: pointer;
}
.boxMob .boxCommand .cmdSelect { background-image: url('assets/images/ico-select.png') }
.boxMob .boxCommand .cmdEdit { background-image: url('assets/images/ico-edit.png'); }

.boxMob:hover .mobName 		{ display: block; }
.boxMob:hover .boxCommand 	{ visibility: visible; }

.boxSelected .boxPortrait	{ border: 3px solid #0051a7;}




#boxCommandType 	{}
#boxMobCustomizer		{ display: none; }
#boxSpawnerCustomizer	{ display: none; }



#txtResult	{ width: 80%; height: 50px; background: #333; color: #0f0; padding: 4px; border: 1px solid #000; }
</style>

</head>

<body>
	<header>
		<h1>Minecraft Command Generator</h1>
	</header>

	<section>

		<div id="boxCommandType" class="boxGeneric">
			Select the type of command you want:<br/>
			<input type="radio" id="radSpawner" name="radCmdType" value="spawner"><label for="radSpawner">Create Mob Spawner</label> &nbsp;
			<input type="radio" id="radSummon" name="radCmdType" value="summon"><label for="radSummon">Summon Mob</label> &nbsp;
			<input type="radio" id="radItem" name="radCmdType" value="item"><label for="radItem">Give Item</label> &nbsp;
			<input type="radio" id="radPotion" name="radCmdType" value="potion" disabled><label for="radPotion">Give Potion</label>
		</div>


		<div id="boxMobType" class="boxGeneric">
		</div>
		<div id="boxMobCustomizer" class="boxGeneric">
		</div>


		<div id="boxSpawnerCustomizer"  class="boxGeneric">
			<b>Spawner parameters:</b><br/>

			<label for="txtSPWSpawnCount" title="Max amount of mobs per spawn">SpawnCount:</label>
			<input type='text' id='txtSPWSpawnCount' /> <br/>

			<label for="txtSPWSpawnRange" title="Spawn area range">SpawnRange:</label>
			<input type='text' id='txtSPWSpawnRange' /> <br/>

			<label for="txtSPWDelayNext" title="Next spawn delay">Delay:</label>
			<input type='text' id='txtSPWDelayNext' /> ticks <br/>

			<label for="txtSPWDelayMin">MinSpawnDelay:</label>
			<input type='text' id='txtSPWDelayMin' /> ticks <br/>

			<label for="txtSPWDelayMax">MaxSpawnDelay:</label>
			<input type='text' id='txtSPWDelayMax' /> ticks <br/>

			<label for="txtSPWMaxMobs" title="Max amount of mobs around the spawner">MaxNearbyEntities:</label>
			<input type='text' id='txtSPWMaxMobs' /><br/>

			<label for="txtSPWPlayerRange" title="Activation range">RequiredPlayerRange:</label>
			<input type='text' id='txtSPWPlayerRange' /><br/>
		</div>




		<div id="boxResult" class="boxGeneric">
			<label for="txtResult">Command:</label><br/>
			<textarea id="txtResult" onclick="this.select()"></textarea>
		</div>



		<button id="btDebug" onclick="generateCommand();">TEST (create command)</button>



	</section>

	<footer>
		version alpha 0.1 - follow this project on <a href="https://github.com/sidben/MCCommandGenerator" target="_blank">GitHub</a><br/>
		icons designed by <a href="http://flaticon.com/" target="_blank">Flaticon.com</a><br/>
		This tool is not supported by Mojang in any way. Minecraft, its images and materials are trademarks and copyrights of Mojang AB.
	</footer>
</body>



<script type="text/javascript" src="assets/js/objects.js"></script>
<script>
//--- CONTANSTS AND GLOBAL VARIABLES ---//

var mcCommand = new MinecraftCommand('spawner');



//--- CUSTOM OBJECTS ---//

function Mob(id, tooltip, picture, dftHealth) {
	this.EntityId 		= id;
	this.Tooltip 		= tooltip;
	this.Picture 		= picture;
	this.DefaultHealth 	= dftHealth;
}



//--- INITIALIZATION ---//
var mobList = [];
mobList[0] = new Mob('Zombie', 'Zombie', 'zombie.png', 20);
mobList[1] = new Mob('Skeleton', 'Skeleton', 'skeleton.png', 20);
mobList[2] = new Mob('Spider', 'Spider', 'spider.png', 16);
mobList[3] = new Mob('CaveSpider', 'Cave Spider', 'cave_spider.png', 12);
mobList[4] = new Mob('Creeper', 'Creeper', 'crepper.png', 20);
mobList[5] = new Mob('Enderman', 'Enderman', 'enderman.png', 40);
mobList[6] = new Mob('VillagerGolem', 'Iron Golem', '150px-Village_Golem.png', 100);
mobList[7] = new Mob('Blaze', 'Blaze', 'Blaze_(Icon).png', 20);
mobList[8] = new Mob('Witch', 'Witch', 'witch.png', 26);
//mobList[7] = new Mob('Villager', 'Villager', 20);




var txtResult 	= document.getElementById("txtResult");
var radType 	= document.getElementsByName("radCmdType");





function start() {
	var tempButton = document.getElementById("btDebug");


	//--- Attach events
	if(tempButton.addEventListener){
		tempButton.addEventListener("click", generateCommand(), true);
	}else{
		tempButton.attachEvent("click", generateCommand());
	};

	radType[0].addEventListener("click", function() { setCommandType('spawner'); }, true);
	radType[1].addEventListener("click", function() { setCommandType('summon'); }, true);
	radType[2].addEventListener("click", function() { setCommandType('item'); }, true);
	radType[3].addEventListener("click", function() { setCommandType('potion'); }, true);



	//-- Initial values
	txtResult.value = '';
	setCommandType('spawner');


	//getValueFromRadio(radType)
}


function initializeSpawnerProperties() {
	document.getElementById("txtSPWSpawnCount").value = SPW_DEFAULT_SPAWNCOUNT;
	document.getElementById("txtSPWSpawnRange").value = SPW_DEFAULT_SPAWNRANGE;
	document.getElementById("txtSPWDelayMin").value = SPW_DEFAULT_MINDELAY;
	document.getElementById("txtSPWDelayMax").value = SPW_DEFAULT_MAXDELAY;
	document.getElementById("txtSPWMaxMobs").value = SPW_DEFAULT_MAXNEARBYMOBS;
	document.getElementById("txtSPWPlayerRange").value = SPW_DEFAULT_PLAYERRANGE;
}



// Captures the values of the form and send it to the command internal object.
function captureForm() {

	//--- capture mob spawner propeties ---//
	if (mcCommand.NBTInfo instanceof MinecraftMobSpawner) {

mcCommand.NBTInfo.EntityId = 'Zombie';	// !!TEMP!!


		mcCommand.NBTInfo.SpawnCount 			= parseInt(document.getElementById("txtSPWSpawnCount").value);
		mcCommand.NBTInfo.SpawnRange 			= parseInt(document.getElementById("txtSPWSpawnRange").value);
		mcCommand.NBTInfo.Delay 				= parseInt(document.getElementById("txtSPWDelayNext").value);
		mcCommand.NBTInfo.MinSpawnDelay 		= parseInt(document.getElementById("txtSPWDelayMin").value);
		mcCommand.NBTInfo.MaxSpawnDelay 		= parseInt(document.getElementById("txtSPWDelayMax").value);
		mcCommand.NBTInfo.MaxNearbyEntities 	= parseInt(document.getElementById("txtSPWMaxMobs").value);
		mcCommand.NBTInfo.RequiredPlayerRange 	= parseInt(document.getElementById("txtSPWPlayerRange").value);
	}

}



function createMobSelector(container) {
	var mobBoxHtml = '';


	container.innerHTML = "<b>Select the mob type:</b><br/>";

	for (var i=0; i<mobList.length; i++) {
		mobBoxHtml = "<div class='boxMob' id='mob" + i + "'>";

		mobBoxHtml += "<div class='boxPortrait' onclick='setMainMob(" + i + ")' ondblclick='setMainMob(" + i + ", true)'>";
		mobBoxHtml += "<img src='assets/images/" + mobList[i].Picture + "' alt='" + mobList[i].Tooltip + "' title='" + mobList[i].Tooltip + "' />";
		mobBoxHtml += "<div class='mobName'>" + mobList[i].Tooltip + "</div>"
		mobBoxHtml += "</div>";

		mobBoxHtml += "<div class='boxCommand'>";
		mobBoxHtml += "<span class='cmdSelect' onclick='setMainMob(" + i + ")'>Select</span>";
		mobBoxHtml += "<span class='cmdEdit' onclick='setMainMob(" + i + ", true)'>Edit</span>";
		mobBoxHtml += "</div>";

		mobBoxHtml += "</div>";
		container.innerHTML += mobBoxHtml;
	}

	// OBS 1 (?): Create groups: vanilla (basic) mobs | Presets (?) | My mobs (saved locally)
}




function createMobCustomizer(container) {
	var mobBoxHtml = '';

	//--- validation ---
	if (mcCommand.MainMob === undefined) { showErrorMessage("No mob selected"); return; }


	mobBoxHtml = "<b>Customize your mob:</b><br/>";

	//--- mob picture ---
	mobBoxHtml += "<div class='boxMob'>";

	mobBoxHtml += "<div class='boxPortrait'>";
	mobBoxHtml += "<img src='assets/images/" + mcCommand.MainMob.Picture + "' alt='" + mcCommand.MainMob.Tooltip + "' title='" + mcCommand.MainMob.Tooltip + "' />";
	mobBoxHtml += "</div>";

	mobBoxHtml += "</div>";


	//--- mob properties and modifiers ---
	mobBoxHtml += "Preset name: <input type='text' value='Custom " +  mcCommand.MainMob.Tooltip + "' /> <br/>"

	mobBoxHtml += "<br/><br/> <b>GLOBAL PROPERTIES</b><br/>"
	mobBoxHtml += "Health: <input type='text' value='" + mcCommand.MainMob.DefaultHealth + "' /> <br/>"
	mobBoxHtml += "Custom name: <input type='text' /> <br/>"
	mobBoxHtml += "Custom name visible: YES / NO <br/>"
	mobBoxHtml += "Can pick up loot: YES / NO <br/>"
	mobBoxHtml += "Persistent (will not despawn): YES / NO <br/>"

	mobBoxHtml += "<br/><br/> <b>UNIQUE PROPERTIES</b><br/>"
	switch(mcCommand.MainMob.EntityId) {
		case 'Creeper':
			mobBoxHtml += "Charged: YES / NO <br/>"
			mobBoxHtml += "Explosion radius: <input type='text' value='3' /> <br/>"
			mobBoxHtml += "Fuse: <input type='text' value='30' /> ticks <br/>"
			break;

		case 'Enderman':
			mobBoxHtml += "Carried block: <input type='text' /> <br/>"
			break;

		case 'Guast':
			mobBoxHtml += "Explosion power: <input type='text' value='1' /> <br/>"
			break;

		case 'PigZombie':
			mobBoxHtml += "Angry: YES / NO <br/>"
			break;

		case 'Skeleton':
			mobBoxHtml += "Type: Regular / Wither / undefined<br/>"
			break;

		case 'Villager':
			mobBoxHtml += "Profession: <input type='text' value='1' /> <br/>"
			break;

		case 'VillagerGolem':
			mobBoxHtml += "Player created (don't attack players): YES / NO <br/>"
			break;

		case 'Wolf':
			mobBoxHtml += "Angry: YES / NO <br/>"
			break;

		case 'Zombie':
			mobBoxHtml += "Villager: YES / NO <br/>"
			mobBoxHtml += "Baby: YES / NO <br/>"
			mobBoxHtml += "Can break doors: YES / NO <br/>"
			break;

	}


	mobBoxHtml += "<br/><br/> <b>ATTRIBUTES</b><br/>"

	mobBoxHtml += "<br/><br/> <b>EQUIPMENT</b><br/>"

	mobBoxHtml += "<br/><br/> <b>POTION EFFECTS</b><br/>"


	mobBoxHtml += "<br/><br/> TODO: save as / reset to default (confirm) / Cancel (confirm)"

	container.innerHTML = mobBoxHtml;
}




function setCommandType(type) {
	mcCommand.Type = type;

	switch(type) {
		case 'spawner':
			mcCommand.NBTInfo = new MinecraftMobSpawner();

			radType[0].checked = true;
			showPropertiesBox('spawnerBasic');
			break;

		case 'summon':
			radType[1].checked = true;
			showPropertiesBox('summon');
			break;

		case 'item':
			radType[2].checked = true;
			showPropertiesBox('item');		// ToDo
			break;

		case 'potion':
			radType[3].checked = true;
			showPropertiesBox('potion');	// ToDo
			break;

		default:
			mcCommand.type = "INVALID";
	}
}




function showPropertiesBox(boxType) {
	var bMobType 		= document.getElementById("boxMobType");
	var bSpawnerProps 	= document.getElementById("boxSpawnerCustomizer");
	var bMobProps 		= document.getElementById("boxMobCustomizer");


	bMobType.style.display 			= 'none';
	bSpawnerProps.style.display 	= 'none';
	bMobProps.style.display 		= 'none';


	switch(boxType) {
		case 'spawnerBasic':
			bMobType.style.display = 'block';
			bSpawnerProps.style.display = 'block';
			initializeSpawnerProperties();
			createMobSelector(bMobType);
			break;

		case 'spawnerCustom':
			bMobProps.style.display = 'block';
			bSpawnerProps.style.display = 'block';
			initializeSpawnerProperties();
			createMobCustomizer(bMobProps);
			break;

		case 'summon':
			bMobType.style.display = 'block';
			createMobSelector(bMobType);
			break;

	}
}





function setMainMob(index, customize) {
	// OBS: If in the future 'boxSelected' gets reused, change this to a loop on mobList

	//-- remove the 'selected' class from everyone --
	var currentSelectedList = document.getElementsByClassName('boxSelected');
	for (var j=0; j<currentSelectedList.length; j++) {
		currentSelectedList[j].className = currentSelectedList[j].className.replace('boxSelected', '');
	}

	//-- add the 'selected' class to the actual selection --
	document.getElementById("mob" + index).className += ' boxSelected';

	//-- Save what mob was selected --
	mcCommand.MainMob = mobList[index];

	//-- Show the customization/edit box if needed --
	if (customize === true) showPropertiesBox('spawnerCustom');
}



function generateCommand() {
	// DEBUG //
	console.log(JSON.stringify(mcCommand));

	captureForm();
	txtResult.value = mcCommand.getCommand();
}




function getValueFromRadio(element) {
	for (var i=0; i<element.length; i++) {
		if (element[i].checked) { return element[i].value; }
	}
	return '';
}



function showErrorMessage(msg) {
	alert("ERROR: " + msg);
}




window.onload = start();



</script>


</html>